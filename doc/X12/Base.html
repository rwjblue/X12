<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class X12::Base - X12 -- an X12 parsing library</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/X12/Base.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="../Object.html">Object</a>
  
</nav>

    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-do_repeats">#do_repeats</a>
    
    <li ><a href="#method-i-each_repeat">#each_repeat</a>
    
    <li ><a href="#method-i-find">#find</a>
    
    <li ><a href="#method-i-has_content-3F">#has_content?</a>
    
    <li ><a href="#method-i-has_displayable_content-3F">#has_displayable_content?</a>
    
    <li ><a href="#method-i-initialize_copy">#initialize_copy</a>
    
    <li ><a href="#method-i-inspect">#inspect</a>
    
    <li ><a href="#method-i-method_missing">#method_missing</a>
    
    <li ><a href="#method-i-repeat">#repeat</a>
    
    <li ><a href="#method-i-required">#required</a>
    
    <li ><a href="#method-i-set_empty-21">#set_empty!</a>
    
    <li ><a href="#method-i-show">#show</a>
    
    <li ><a href="#method-i-size">#size</a>
    
    <li ><a href="#method-i-to_a">#to_a</a>
    
    <li ><a href="#method-i-to_s">#to_s</a>
    
    <li ><a href="#method-i-with">#with</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../CHANGELOG.html">CHANGELOG</a>
  
    <li class="file"><a href="../README.html">README</a>
  
    <li class="file"><a href="../TODO.html">TODO</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../Object.html">Object</a>
  
    <li><a href="../X12.html">X12</a>
  
    <li><a href="../X12/Base.html">X12::Base</a>
  
    <li><a href="../X12/Composite.html">X12::Composite</a>
  
    <li><a href="../X12/Field.html">X12::Field</a>
  
    <li><a href="../X12/Loop.html">X12::Loop</a>
  
    <li><a href="../X12/Parser.html">X12::Parser</a>
  
    <li><a href="../X12/Segment.html">X12::Segment</a>
  
    <li><a href="../X12/Table.html">X12::Table</a>
  
    <li><a href="../X12/XMLDefinitions.html">X12::XMLDefinitions</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class X12::Base</h1>

  <div id="description" class="description">
    
<p>$Id: Base.rb 70 2009-03-26 19:25:39Z ikk $</p>

<p><a href="Base.html">Base</a> class for <a href="Segment.html">Segment</a>,
<a href="Composite.html">Composite</a>, and <a href="Loop.html">Loop</a>.
Contains setable <a
href="Base.html#attribute-i-segment_separator">#segment_separator</a>, <a
href="Base.html#attribute-i-field_separator">#field_separator</a>, and <a
href="Base.html#attribute-i-composite_separator">#composite_separator</a>
fields.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-alias" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">alias</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p><code>alias</code> can be used to access the node instead of
<code>name</code>; also, nodes with aliases are collected in
<code>to_hsh</code> call</p>
        
        </div>
      </div>
      
      <div id="attribute-i-composite_separator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">composite_separator</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Character that separates value parts fields in the composite field (usually
‘:’)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-error" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">error</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Human readable error message as determined by <code>valid?</code> method</p>
        
        </div>
      </div>
      
      <div id="attribute-i-error_code" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">error_code</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Error code as per <a href="../X12.html">X12</a> specifications as
determined by <code>valid?</code> method</p>
        
        </div>
      </div>
      
      <div id="attribute-i-field_separator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">field_separator</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Character that separates fields in the segment (usually ‘*’)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-name" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">name</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Name of the node</p>
        
        </div>
      </div>
      
      <div id="attribute-i-next_repeat" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">next_repeat</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Pointer to the next repeat of this node, or <code>nil</code> if none</p>
        
        </div>
      </div>
      
      <div id="attribute-i-nodes" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">nodes</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Collection of child nodes</p>
        
        </div>
      </div>
      
      <div id="attribute-i-parent" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parent</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Parent node of this one</p>
        
        </div>
      </div>
      
      <div id="attribute-i-parsed_str" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parsed_str</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>String from which the particular node was generated during parsing</p>
        
        </div>
      </div>
      
      <div id="attribute-i-repeats" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">repeats</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p><code>Range</code> determining max and min repeats of the node</p>
        
        </div>
      </div>
      
      <div id="attribute-i-segment_separator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">segment_separator</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Character that separates segments in the document (usually ‘~’)</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(params = {}, nodes = [])</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new base element with given parameters and array of sub-elements</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">params</span> = {}, <span class="ruby-identifier">nodes</span> = [])
  <span class="ruby-ivar">@error</span>               = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@error_code</span>          = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@name</span>                = <span class="ruby-identifier">params</span>[<span class="ruby-value">:name</span>]
  <span class="ruby-ivar">@alias</span>               = <span class="ruby-identifier">params</span>[<span class="ruby-value">:alias</span>]
  <span class="ruby-ivar">@nodes</span>               = <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">parent</span> = <span class="ruby-keyword">self</span> }
  <span class="ruby-ivar">@repeats</span>             = <span class="ruby-constant">Range</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:min</span>], <span class="ruby-identifier">params</span>[<span class="ruby-value">:max</span>])
  <span class="ruby-ivar">@next_repeat</span>         = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@parsed_str</span>          = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@parent</span>              = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@segment_separator</span>   = <span class="ruby-string">'~'</span>
  <span class="ruby-ivar">@field_separator</span>     = <span class="ruby-string">'*'</span>
  <span class="ruby-ivar">@composite_separator</span> = <span class="ruby-string">':'</span>

  <span class="ruby-comment">#puts &quot;Created #{name} #{object_id} #{self.class}  &quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(*args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The main method implementing Ruby-like access methods for repeating
elements</p>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 185</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-comment">#puts &quot;squares #{args.inspect}&quot;</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_a</span>[<span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- 5B-5D-source -->
          
        </div>

        

        
      </div><!-- 5B-5D-method -->

    
      <div id="method-i-do_repeats" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">do_repeats</span><span
            class="method-args">(s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Check if the source string contains one more repeat of the current element,
and parse it if it is so. Returns the unconsumed part of the string.</p>
          
          

          
          <div class="method-source-code" id="do_repeats-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_repeats</span>(<span class="ruby-identifier">s</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">repeats</span>.<span class="ruby-identifier">end</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">possible_repeat</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">p_s</span> = <span class="ruby-identifier">possible_repeat</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">s</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">p_s</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">s</span> = <span class="ruby-identifier">p_s</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">next_repeat</span> = <span class="ruby-identifier">possible_repeat</span>
    <span class="ruby-keyword">end</span> <span class="ruby-comment"># if parsed</span>
  <span class="ruby-keyword">end</span> <span class="ruby-comment"># more repeats</span>
  <span class="ruby-identifier">s</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- do_repeats-source -->
          
        </div>

        

        
      </div><!-- do_repeats-method -->

    
      <div id="method-i-each_repeat" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_repeat</span><span
            class="method-args">() { |repeat| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates through all the repeats of this object without putting them into
array first (to_a.each)</p>
          
          

          
          <div class="method-source-code" id="each_repeat-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_repeat</span>
  <span class="ruby-identifier">repeat</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">until</span> <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">repeat</span>)
    <span class="ruby-identifier">repeat</span> = <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">next_repeat</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_repeat-source -->
          
        </div>

        

        
      </div><!-- each_repeat-method -->

    
      <div id="method-i-find" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find</span><span
            class="method-args">(e)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Prototype method to be overloaded</p>
          
          

          
          <div class="method-source-code" id="find-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find</span>(<span class="ruby-identifier">e</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-string">'Subclass responsebility'</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- find-source -->
          
        </div>

        

        
      </div><!-- find-method -->

    
      <div id="method-i-has_content-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">has_content?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>True if any of the nodes below have user-provided content. That does not
include variables or constants. There’s no need to check repeats, because
the only way for an element to be empty is to be the first and only in the
repeats list.</p>
          
          

          
          <div class="method-source-code" id="has_content-3F-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 199</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">has_content?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">has_content?</span> }
<span class="ruby-keyword">end</span></pre>
          </div><!-- has_content-3F-source -->
          
        </div>

        

        
      </div><!-- has_content-3F-method -->

    
      <div id="method-i-has_displayable_content-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">has_displayable_content?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>True if any of the nodes below have content that needs to be displayed -
that includes both user-provided content and variables. There’s no need to
check repeats, because only the first and only element on the repeats list
may be empty.</p>
          
          

          
          <div class="method-source-code" id="has_displayable_content-3F-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 207</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">has_displayable_content?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">has_displayable_content?</span> }
<span class="ruby-keyword">end</span></pre>
          </div><!-- has_displayable_content-3F-source -->
          
        </div>

        

        
      </div><!-- has_displayable_content-3F-method -->

    
      <div id="method-i-initialize_copy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_copy</span><span
            class="method-args">(original_object)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initialize the fresh copy of the object made by <code>dup</code> by
cleaning up user data and cloning all of the original’s nodes.</p>
          
          

          
          <div class="method-source-code" id="initialize_copy-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_copy</span>(<span class="ruby-identifier">original_object</span>)
  <span class="ruby-identifier">set_empty!</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span> = <span class="ruby-identifier">original_object</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">child</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">child_copy</span> = <span class="ruby-identifier">child</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">child_copy</span>.<span class="ruby-identifier">parent</span> = <span class="ruby-keyword">self</span>
    <span class="ruby-identifier">child_copy</span>
  }

  <span class="ruby-comment">#puts &quot;Duped #{original_object.class} #{original_object.name} #{original_object.object_id} #{original_object.super.object_id} -&gt; #{self.name} #{self.super.object_id} #{self.object_id} &quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_copy-source -->
          
        </div>

        

        
      </div><!-- initialize_copy-method -->

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Formats a printable string containing the element’s content</p>
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-node">&quot;#{self.class.to_s.sub(/^.*::/, '')} (#{name}) #{repeats} #{super.inspect[1..-2]} =&lt;#{parsed_str}, #{next_repeat.inspect}&gt; &quot;</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\*\&quot;/</span>, <span class="ruby-string">'&quot;'</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- inspect-source -->
          
        </div>

        

        
      </div><!-- inspect-method -->

    
      <div id="method-i-method_missing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">method_missing</span><span
            class="method-args">(meth, *args) { |res| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The main method implementing Ruby-like access methods for nested elements. 
To address nodes with purely numeric names (i.e. 270, 997, etc.), prefix
them with an underscore.</p>
          
          

          
          <div class="method-source-code" id="method_missing-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">str</span> = <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-identifier">str</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^_\d+$/</span>
  <span class="ruby-comment">#puts &quot;Missing #{str}&quot;</span>
  <span class="ruby-identifier">res</span> = <span class="ruby-identifier">find</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">res</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">res</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- method_missing-source -->
          
        </div>

        

        
      </div><!-- method_missing-method -->

    
      <div id="method-i-repeat" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">repeat</span><span
            class="method-args">() { |new_repeat| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a fresh repeat of this element ready to be filled with user content
-  either self, or a fresh copy.</p>
          
          

          
          <div class="method-source-code" id="repeat-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 213</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">repeat</span>
  <span class="ruby-identifier">new_repeat</span> = <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">has_content?</span> <span class="ruby-comment"># Do not repeat an empty segment</span>
                 <span class="ruby-identifier">last_repeat</span> = <span class="ruby-keyword">self</span>
                 <span class="ruby-identifier">last_repeat</span> = <span class="ruby-identifier">last_repeat</span>.<span class="ruby-identifier">next_repeat</span> <span class="ruby-keyword">until</span> <span class="ruby-identifier">last_repeat</span>.<span class="ruby-identifier">next_repeat</span>.<span class="ruby-identifier">nil?</span>
                 <span class="ruby-identifier">last_repeat</span>.<span class="ruby-identifier">next_repeat</span> = <span class="ruby-identifier">last_repeat</span>.<span class="ruby-identifier">dup</span>
               <span class="ruby-keyword">else</span>
                 <span class="ruby-keyword">self</span>
               <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">new_repeat</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">new_repeat</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- repeat-source -->
          
        </div>

        

        
      </div><!-- repeat-method -->

    
      <div id="method-i-required" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">required</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns <code>true</code> is this element has to be present in the output
(“Mandatory” per <a href="../X12.html">X12</a> standard)</p>
          
          

          
          <div class="method-source-code" id="required-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">required</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">repeats</span>.<span class="ruby-identifier">begin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- required-source -->
          
        </div>

        

        
      </div><!-- required-method -->

    
      <div id="method-i-set_empty-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_empty!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Empty out the current element</p>
          
          

          
          <div class="method-source-code" id="set_empty-21-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_empty!</span>
  <span class="ruby-ivar">@next_repeat</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@parsed_str</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- set_empty-21-source -->
          
        </div>

        

        
      </div><!-- set_empty-21-method -->

    
      <div id="method-i-show" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">show</span><span
            class="method-args">(indent = '')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Prints a tree-like representation of the element</p>
          
          

          
          <div class="method-source-code" id="show-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>(<span class="ruby-identifier">indent</span> = <span class="ruby-string">''</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span>.<span class="ruby-identifier">with_index</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-comment">#puts &quot;#{indent}#{n.name} #{n.object_id} #{n.super.object_id} [#{i}]: #{n.parsed_str} #{n.super.class}&quot;</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{indent}#{n.name} [#{i}]: #{n.to_s.sub(/^(.{30})(.*?)(.{30})$/, '\1...\3')}&quot;</span>

    <span class="ruby-identifier">n</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">case</span> 
      <span class="ruby-keyword">when</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">X12</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>)  <span class="ruby-keyword">then</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">show</span>(<span class="ruby-identifier">indent</span> <span class="ruby-operator">+</span> <span class="ruby-string">'  '</span>)
      <span class="ruby-keyword">when</span> <span class="ruby-identifier">j</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">X12</span><span class="ruby-operator">::</span><span class="ruby-constant">Field</span>) <span class="ruby-keyword">then</span> <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{indent}  #{j.name} -&gt; '#{j.to_s}'&quot;</span>
      <span class="ruby-keyword">end</span>
    } 
  }
<span class="ruby-keyword">end</span></pre>
          </div><!-- show-source -->
          
        </div>

        

        
      </div><!-- show-method -->

    
      <div id="method-i-size" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">size</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Number of repeats of this element, starting with self.</p>
          
          

          
          <div class="method-source-code" id="size-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 147</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">size</span>
  <span class="ruby-identifier">s</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">repeat</span> = <span class="ruby-keyword">self</span>        <span class="ruby-comment"># Yes, this loop is used in a few places, but extracting it into a</span>
  <span class="ruby-keyword">until</span> <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">do</span> <span class="ruby-comment"># separate method causes about 20% performance drop due to yield overhead.</span>
    <span class="ruby-identifier">s</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">repeat</span> = <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">next_repeat</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">s</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- size-source -->
          
        </div>

        

        
      </div><!-- size-method -->

    
      <div id="method-i-to_a" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_a</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the array of repeats of this element, starting with self.</p>
          
          

          
          <div class="method-source-code" id="to_a-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 158</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_a</span>
  <span class="ruby-identifier">res</span> = []
  <span class="ruby-identifier">repeat</span> = <span class="ruby-keyword">self</span>        <span class="ruby-comment"># Yes, this loop is used in a few places, but extracting it into a</span>
  <span class="ruby-keyword">until</span> <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">do</span> <span class="ruby-comment"># separate method causes about 20% performance drop due to yield overhead.</span>
    <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">repeat</span>
    <span class="ruby-identifier">repeat</span> = <span class="ruby-identifier">repeat</span>.<span class="ruby-identifier">next_repeat</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">res</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_a-source -->
          
        </div>

        

        
      </div><!-- to_a-method -->

    
      <div id="method-i-to_s" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a parsed string representation of the element</p>
          
          

          
          <div class="method-source-code" id="to_s-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 169</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@parsed_str</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">render</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_s-source -->
          
        </div>

        

        
      </div><!-- to_s-method -->

    
      <div id="method-i-with" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with</span><span
            class="method-args">() { |self| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Yields to accompanying block passing self as a parameter.</p>
          
          

          
          <div class="method-source-code" id="with-source">
            <pre><span class="ruby-comment"># File lib/X12/Base.rb, line 191</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">yield</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- with-source -->
          
        </div>

        

        
      </div><!-- with-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.1.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

